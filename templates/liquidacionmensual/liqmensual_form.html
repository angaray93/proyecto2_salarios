{% extends "liquidacionmensual/liqmensual_list.html" %}
{% load staticfiles %}
{% load django_bootstrap_breadcrumbs %}
{% load humanize %}
{% load l10n %}

{% block breadcrumbs %}
    {{ block.super }}
    {% breadcrumb " Liquidaciones Pendientes " 'liquidacion:index' %}
{% endblock %}

{% block content %}
{% render_breadcrumbs %}

<div class="col-12 col-sm-10 recuadro">

{% if advertencia %}
<div class="alert alert-warning alert-dismissible fade show" role="alert">
    {{ advertencia }}
  <button type="button" class="close" data-dismiss="alert" aria-label="Close">
    <span aria-hidden="true">&times;</span>
  </button>
</div>
{% endif %}

 <form method="post" id="liqmensual_form"> <!--FORM -->
    {% csrf_token %}
    <hr>
        <input type="hidden" name="ultimamodificacion" value="{{ liquidacion.ultimamodificacion|unlocalize }}">
        <input type="hidden" name="propietario" value="{{ liquidacion.propietario }}">
        <input type="hidden" name="tipo" value="{{ liquidacion.tipo }}">

        <div class="row separador"></div>
        <div class="row mt-2"> <!-- botones -->
                <div class="col-12">
                    <div class="row">
                        <div class="col-md-3 col-sm-3 btn_sep">
                            <button type="submit" form="liqmensual_form"
                                    name="descartar" value="Descartar"
                                    formaction="{% url 'liquidacion:editar_liquidacion' liquidacion.pk %}"
                                    class="btn" style="width: 100%">
                                Descartar
                            </button>
                        </div>
                        <div class="col-md-3 col-sm-3 btn_sep">
                            <button type="submit" form="liqmensual_form"
                                    name="confirmar" value="Confirmar"
                                    class="btn" style="width: 100%">
                                Confirmar
                            </button>
                        </div>
                        <div class="col-md-3 col-sm-3 btn_sep">
                            <button type="submit" form="liqmensual_form"
                                    name="guardar" value="Guardar"
                                    class="btn" style="width: 100%">
                                Guardar Borrador
                            </button>
                        </div>
                    </div>
                </div>
            </div><!-- fin botones -->
    <hr>
        <div class="row mt-2">
            <div class="col-12 col-sm-6">
                <div class="form-group">
                    <label for="fechacreacion">Fecha de Creacion:</label>
                    {% if liquidacion %}
                        <input type="text" class="form-control"
                               value="{{ liquidacion.fechacreacion }}" disabled/>
                        <input type="hidden" name="fechacreacion" value="{{ liquidacion.fechacreacion|date:"d/m/Y H:i" }}">
                    {% endif %}
                </div>
            </div>
            <div class="col-12 col-sm-6">
                <div class="form-group">
                    <label for="mes">Mes:</label>
                    {% if liquidacion %}
                        <input type="text" class="form-control"
                               value="{{ liquidacion.mes }}" disabled/>
                        <input type="hidden" name="mes" value="{{ liquidacion.mes }}">
                    {% endif %}
                </div>
            </div>
        </div>
        <div class="row mt-2">
            <div class="col-12 col-sm-6">
                <div class="form-group">
                    <label for="total_debito">Total Debito:</label>
                    {% if liquidacion %}
                        <input type="text" class="form-control"
                               value="{{ liquidacion.total_debito }}" disabled/>
                        <input type="hidden" name="total_debito" value="{{ liquidacion.total_debito|unlocalize }}">
                    {% endif %}
                </div>
            </div>
            <div class="col-12 col-sm-6">
                <div class="form-group">
                    <label for="total_credito">Total Credito:</label>
                    {% if liquidacion %}
                        <input type="text" class="form-control"
                               value="{{ liquidacion.total_credito|intcomma }}" disabled/>
                        <input type="hidden" name="total_credito" value="{{ liquidacion.total_credito|unlocalize }}">
                    {% endif %}
                </div>
            </div>
        </div>
        <div class="row mt-2">
            <div class="col-12 col-sm-6">
                <div class="form-group">
                    <label for="total_liquidacion">Total Liquidacion:</label>
                    {% if liquidacion %}
                        <input type="text" class="form-control"
                               value="{{ liquidacion.total_liquidacion }}" disabled/>
                        <input type="hidden" name="total_liquidacion" value="{{ liquidacion.total_liquidacion|unlocalize }}">
                    {% endif %}
                </div>
            </div>
            <div class="col-12 col-sm-6">
                <div class="form-group">
                    <label for="inicio_periodo">Inicio Periodo:</label>
                    {% if liquidacion %}
                        <input type="text" class="form-control"
                               value="{{ liquidacion.inicio_periodo|date:"d/m/Y" }}" disabled/>
                        <input type="hidden" name="inicio_periodo" value="{{ liquidacion.inicio_periodo|date:"d/m/Y H:i" }}">
                    {% endif %}
                </div>
            </div>
        </div>
        <div class="row mt-2">
            <div class="col-12 col-sm-6">
                <div class="form-group">
                    <label for="fin_periodo">Fin del periodo:</label>
                    {% if liquidacion %}
                        <input type="text" class="form-control"
                               value="{{ liquidacion.fin_periodo|date:"d/m/Y" }}" disabled/>
                        <input type="hidden" name="fin_periodo" value="{{ liquidacion.fin_periodo|date:"d/m/Y H:i" }}">
                    {% endif %}
                </div>
            </div>
            <div class="col-12 col-sm-6">
                <div class="form-group">
                    <label for="funcionario">Funcionario:</label>
                    {% if liquidacion %}
                        <input type="text" class="form-control"
                               value="{{ liquidacion.funcionario }}" disabled/>
                        <input type="hidden" name="funcionario" value="{{ liquidacion.funcionario.pk }}">
                    {% endif %}
                </div>
            </div>
        </div>
        <div class="row mt-2">
            <div class="col-12 col-sm-6">
                <div class="form-group">
                    <label for="estado_actual">Estado:</label>
                    {% if liquidacion %}
                        <input type="text" class="form-control"
                               value="{{ liquidacion.estado_actual }}" disabled/>
                        <input type="hidden" name="estado_actual" value="{{ liquidacion.estado_actual.pk }}">
                    {% endif %}
                </div>
            </div>
        </div>
</form> <!-- FIN FORM -->
<hr>

<div class="row">
        <div class="col-lg-12">
        <table id="tabla_liqhaberes" class="table table-hover">
            <thead class="thead-dark">
                <tr>
                    <th class="text-center">Categoria Salarial</th>
                    <th class="text-center">Acciones</th>
                </tr>
            </thead>
            <tbody>
                {% for item in liq_haberes %}
                    <tr class='clickable-row'>
                        <td>{{ item.haber.movimiento.categoria_salarial }}</td>
                        <td class="text-center">
                            <button class="btn btn-outline-primary btn-edit" type="button"
                                onclick="location.href=('{% url 'liquidacion:editar_liquidacionhaber' item.pk %}')">
                                <i class="fa fa-pencil-square-o" aria-hidden="true"></i></button>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
        </div>
    </div>


</div>

<div id="popup" class="modal fade" role="dialog">

</div>

{% endblock %}